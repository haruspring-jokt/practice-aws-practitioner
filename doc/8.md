# 8章データベースサービス

引用元：山下光洋/海老原寛之『AWS認定資格試験テキスト AWS認定クラウドプラクティショナー』

## RDS

### RDSの概要

AWSで簡単にリレーショナルデータベースを使用することができる。使用できるDBは以下の通り。

- Amazon Aurora
- MySQL
- PostgreSQL
- MariaDB
- Oracle
- Microsoft SQL Server

### RDSとEC2の違い

EC2で起動したサービスにDBエンジンをインストールする場合、OSのモジュールに脆弱性が見つかった場合はパッチの適用が必要であり、DBの様々なマネジメントをユーザーが行う必要がある。

#### メンテナンス

RDSでDBを使用すると、管理タスクが不要となる。OSを選択する必要も設定する必要もなくなる。OSのメンテナンスは週に１回自動的に行われ、DBのマイナーバージョンアップデートは、自動適用するかどうかを選択することができる。

#### バックアップ

デフォルトで7日間の自動バックアップが適用されている。期間は0～35日間まで設定でき、指定した時間にバックアップデータが作成される。35日を超えて保持する場合は、スナップショットを作成できる。実体はS3の機能を利用しているため、バックアップデータの耐久性はイレブンナインといえる。

##### ポイントタイムリカバリー

自動バックアップを設定している期間内であれば、秒数までを指定して特定の時点のインスタンスを復元できる。過去直近では5分前に戻すことができる。

#### 高可用性

RDSのマルチAZ配置をオンにすると、AZをまたいだレプリケーションが自動的に行われる。フェイルオーバーも自動。レプリケーション用のユーザー作成や設定、管理は不要。

Aurora、MySQL、PostgreSQL、MariaDBではリードレプリカを作成することができ、リードレプリカにより、読み込み不可をマスターデータベースから軽減できる。

### Amazon Auroraの概要

AWSがクラウドに最適化して再設計したRDS。MySQL、PostgreSQLで動いているアプリケーションはそのままAuroraで動かすことができる。

- バックアップが非常に強固
- スタンバイにアクセスできる（リードレプリカがマスター昇格する）
- リードレプリカは15個作成できる
- MySQLに比べて5倍の性能
- ディスク容量を見込みで確保しなくても自動で増加する

### DMS

移行をサポートする。Amazon Database Migration Service。

同じデータベースでも異なるデータベースでも移行でき、移行先のスキーマ作成もSCT（Schema Conversion Tool）で自動化できる。

## DynamoDB

NoSQL型の高いパフォーマンスを持ったフルマネージド型のデータベースサービス。

使用時にユーザーはリージョンを選択する。AZはユーザーが意識しなくても複数のAZの複数の施設で同期され保存される。

データ容量は無制限で、使用している容量のみが課金対象となる。性能は、書き込みと読み込みのキャパシティユニットを設定することで決定する。これはオートスケールさせることも可能。

### DynamoDBとRDSの違い

DynamoDBは非リレーショナルデータベースまたはNoSQLと言われる。RDSは空席予約など厳密な確定処理をすることに向いているが、大量のデータ更新や読み込みを必要とする処理に向いていない。

これは、RDSが垂直スケーリングであるのに対し、DynamoDBは水平スケーリングを行うためである。

RDSはSQL型であるのに対し、NoSQL型のDynamoDBは不定形な入れものに自由に情報を格納して、キーを検索のためのインデックスとして扱うイメージで、データを管理することができる。

## その他のデータベースサービス

- Amazon Redshift
  - 高速でシンプルなデータウェアハウスサービス。
- Amazon ElasticCache
  - インメモリデータストアサービス。クエリ結果のキャッシュ、アプリケーションのセッション情報を管理する用途で使う。
- Amazon Neptune
  - フルマネージドなグラフデータベースサービス。関係性や相関情報を扱う。
